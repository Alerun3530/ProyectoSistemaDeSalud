{% extends 'base.html' %}

{% block title %}Historial de Novedades - {{ usuario.user.get_full_name }}{% endblock %}

{% block content %}
<div class="container" style="max-width: 1200px; margin: 50px auto; padding: 40px;">
    <!-- Header -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
        <div>
            <h2 style="font-size: 2.5rem; font-weight: 800; color: #1e293b; margin-bottom: 8px;">
                ğŸ“œ Historial de Novedades
            </h2>
            <p style="color: #64748b; font-size: 1.1rem; margin: 0;">
                {{ usuario.user.get_full_name }} - {{ usuario.numero_documento }}
            </p>
        </div>
        <a href="{% url 'ver_afiliacion' afiliacion.id %}" class="btn btn-secondary" 
           style="padding: 12px 24px; border-radius: 8px; font-weight: 600; text-decoration: none; background: #e2e8f0; color: #334155;">
            â† Volver
        </a>
    </div>

    <!-- Stats Card -->
    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 32px; border-radius: 20px; box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4); margin-bottom: 40px; text-align: center;">
        <div style="font-size: 4rem; margin-bottom: 12px;">ğŸ””</div>
        <h3 style="font-size: 3rem; font-weight: 800; margin-bottom: 8px;">{{ total_novedades }}</h3>
        <p style="opacity: 0.9; font-size: 1.2rem; margin: 0;">Novedades Registradas</p>
    </div>

    <!-- Timeline de Novedades -->
    <div class="card" style="background: white; padding: 40px; border-radius: 20px; box-shadow: 0 4px 24px rgba(0,0,0,0.1);">
        <h3 style="font-size: 1.5rem; font-weight: 700; color: #334155; margin-bottom: 30px;">
            ğŸ“‹ LÃ­nea de Tiempo
        </h3>

        {% if novedades %}
        <div style="position: relative;">
            <!-- LÃ­nea vertical del timeline -->
            <div style="position: absolute; left: 20px; top: 0; bottom: 0; width: 3px; background: linear-gradient(180deg, #667eea, #764ba2);"></div>

            {% for novedad in novedades %}
            <div style="position: relative; padding-left: 60px; margin-bottom: 32px;">
                <!-- Punto del timeline -->
                <div style="position: absolute; left: 8px; top: 8px; width: 28px; height: 28px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; border: 4px solid white; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);"></div>

                <!-- Contenido de la novedad -->
                <div style="background: #f8fafc; padding: 24px; border-radius: 12px; border-left: 4px solid #667eea; cursor: pointer; transition: all 0.3s;"
                     onclick="window.location.href='{% url 'ver_novedad' novedad.id %}'"
                     onmouseover="this.style.transform='translateX(8px)'; this.style.boxShadow='0 4px 16px rgba(0,0,0,0.1)'"
                     onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='none'">
                    
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <div>
                            <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">
                                {{ novedad.tipo }}
                            </span>
                        </div>
                        <span style="color: #64748b; font-size: 0.9rem; font-weight: 600;">
                            ğŸ“… {{ novedad.fecha_novedad|date:"d/m/Y" }}
                        </span>
                    </div>

                    <p style="color: #1e293b; font-size: 1.05rem; line-height: 1.6; margin: 0;">
                        {{ novedad.descripcion }}
                    </p>

                    
                </div>
            </div>
            {% endfor %}
        </div>

        {% else %}
        <!-- Estado vacÃ­o -->
        <div style="text-align: center; padding: 80px 20px;">
            <div style="font-size: 5rem; margin-bottom: 24px; opacity: 0.3;">ğŸ“­</div>
            <h3 style="font-size: 1.5rem; font-weight: 700; color: #334155; margin-bottom: 12px;">
                No hay novedades registradas
            </h3>
            <p style="color: #64748b; font-size: 1.05rem; margin-bottom: 24px;">
                Este usuario aÃºn no tiene novedades en su historial
            </p>
            <a href="{% url 'crear_novedad' %}" class="btn btn-primary"
               style="display: inline-block; padding: 12px 24px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 8px; text-decoration: none; font-weight: 600;">
                + Crear Primera Novedad
            </a>
        </div>
        {% endif %}
    </div>

    <!-- BotÃ³n para crear nueva novedad -->
    {% if novedades %}
    <div style="margin-top: 32px; text-align: center;">
        <a href="{% url 'crear_novedad' %}" class="btn btn-primary"
           style="display: inline-flex; align-items: center; gap: 8px; padding: 14px 32px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 10px; text-decoration: none; font-weight: 600; font-size: 1.05rem; box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);">
            <span style="font-size: 1.3rem;">â•</span>
            Registrar Nueva Novedad
        </a>
    </div>
    {% endif %}
</div>

<style>
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4) !important;
    }
</style>
{% endblock %}